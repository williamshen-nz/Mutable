function validURL(a){return new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(a)}function getDomain(a){var b=a.indexOf("://")>-1?a.split("/")[2]:a.split("/")[0],c=b.split(":")[0],d=c.split("."),e=d.length;return e>2&&(c=d[e-2]+"."+d[e-1]),c}function insertHTML(a,b){var c=document.getElementById(a);"success"!==c.lastElementChild.className&&"failure"!==c.lastElementChild.className||c.lastElementChild.remove(),c.insertAdjacentHTML("beforeend",b),setTimeout(function(){"success"!==c.lastElementChild.className&&"failure"!==c.lastElementChild.className||c.lastElementChild.remove()},3e3)}function restoreOptions(){chrome.storage.sync.get({currentWindowOnly:!1,blockedURLs:[]},function(a){document.getElementById("current-window").checked=a.currentWindowOnly,refreshBlacklist(a.blockedURLs,!1)})}function saveWindowOption(){chrome.storage.sync.get({currentWindowOnly:!1},function(){var a=document.getElementById("current-window").checked;chrome.storage.sync.set({currentWindowOnly:a},function(){insertHTML("general",SUCCESS)})})}function addBlacklistURL(){var a=document.getElementById("blacklist-url").value;if(a=getDomain(a),0==a.length||!validURL(a))return void insertHTML("blacklist-add",INVALID);chrome.storage.sync.get({blockedURLs:[]},function(b){var c=b.blockedURLs;if(c.indexOf(a)>-1)return void insertHTML("blacklist-add",EXISTS);c.push(a),chrome.storage.sync.set({blockedURLs:c},function(){insertHTML("blacklist-add",ADDED),refreshBlacklist(a,!0)})})}function refreshBlacklist(a,b){if(document.getElementById("blacklist-url").value="",b)document.getElementById("blacklisted").innerHTML+="<option value="+a+">"+a+"</option>";else{var c="";a.forEach(function(a){c+="<option value="+a+">"+a+"</option>\n"}),document.getElementById("blacklisted").innerHTML=c}}function removeClick(){var a=document.getElementById("blacklisted").selectedOptions;0==a.length&&insertHTML("blacklist-remove",NO_ITEM);for(var b=[],c=0;c<a.length;c++)b.push(a[c].value);removeURLs(b)}function removeURLs(a){chrome.storage.sync.get({blockedURLs:[]},function(b){var c=b.blockedURLs;c=c.filter(function(b){return-1==a.indexOf(b)}),chrome.storage.sync.set({blockedURLs:c},function(){insertHTML("blacklist-remove",REMOVED),refreshBlacklist(c,!1)})})}const SUCCESS='<p class="success">Successfully saved!</p>',INVALID='<p class="failure">Invalid URL!</p>',EXISTS='<p class="failure">URL already exists!</p>',ADDED='<p class="success">Successfully added!</p>',REMOVED='<p class="success">Successfully removed!</p>',NO_ITEM='<p class="failure">No item selected!</p>';document.addEventListener("DOMContentLoaded",function(){restoreOptions(),document.getElementById("current-window").addEventListener("click",function(){saveWindowOption()}),document.getElementById("blacklist-url").addEventListener("keydown",function(a){"13"==a.keyCode&&addBlacklistURL()}),document.getElementById("url-submission").addEventListener("click",function(){addBlacklistURL()}),document.getElementById("link-remove").addEventListener("click",function(){removeClick()})});