function getAllTabs(callback){chrome.tabs.query({currentWindow:true},function(originalTabs){callback(originalTabs);});}
function toggleSound(tab){if(tab.mutedInfo.muted){chrome.tabs.update(tab.id,{muted:false});tab.mutedInfo.muted=false;document.getElementById(tab.id).innerHTML=getInnerHTML(false,tab.title);}else{chrome.tabs.update(tab.id,{muted:true});tab.mutedInfo.muted=true;document.getElementById(tab.id).innerHTML=getInnerHTML(true,tab.title);}}
function toggleTabs(tabs,isMuted){tabs.forEach(function(tab){chrome.tabs.update(tab.id,{muted:(isMuted?true:false)});document.getElementById(tab.id).innerHTML=getInnerHTML(isMuted?true:false,tab.title);});}
document.addEventListener('DOMContentLoaded',function(){var tabController=document.getElementById('tab-controller');var relevantTabs=[];getAllTabs(function(tabs){tabs.forEach(function(tab){if(tab.mutedInfo.muted){relevantTabs.push(tab);tabController.insertAdjacentHTML('beforeend',getButtonHTML(true,tab.title,tab.id));document.getElementById(tab.id).addEventListener('click',function(){toggleSound(tab);});}else if(tab.audible){relevantTabs.push(tab);tabController.insertAdjacentHTML('beforeend',getButtonHTML(false,tab.title,tab.id));document.getElementById(tab.id).addEventListener('click',function(){toggleSound(tab);});}});});document.getElementById('mute-all').addEventListener('click',function(){toggleTabs(relevantTabs,true);});document.getElementById('unmute-all').addEventListener('click',function(){toggleTabs(relevantTabs,false);});});
